var dataPedidos = [
    {
        "ITEM": "1",
        "DOCUMENTO": "T06-00018348",
        "PEDIDO": "P06-10105684",
        "DESCRIPCION": "/ ECONORED DE PANAMA, S.A. .... 01/23/26  2:06:46 PM ",
        "CLIENTE": "ECONORED DE PANAMA, S.A.",
        "TOTAL_UNIDADES": "7.00000000",
        "LINEAS_VERIFICADAS": ".00",
        "LINEAS_PREPARADAS": 0,
        "ESTADO_PEDIDO": "F",
        "USUARIO": "KEVIMOJI",
        "FECHA_FACTURA": "2026-01-28 15:54:50.000",
        "FECHA_PEDIDO": "2026-01-23 00:00:00.000",
        "MODULO": "P",
        "CIA": "B",
        "placa": null,
        "tiene_servicio": "S",
        "SOLICITA": null,
        "ATENDIDO_POR": "Kevin Mojica",
        "FECHA": "2026-01-28 15:54:50.000",
        "ESTADO_PREPARACION": "0"
    },
    {
        "ITEM": "2",
        "DOCUMENTO": "T06-00018340",
        "PEDIDO": "P06-10105454",
        "DESCRIPCION": "SUPREME SERVICES , (PANAMA)N*3,SA  .... 01/17/26  8:23:58 AM ",
        "CLIENTE": "SUPREME SERVICES , (PANAMA)N*3,SA ",
        "TOTAL_UNIDADES": "8.00000000",
        "LINEAS_VERIFICADAS": ".00",
        "LINEAS_PREPARADAS": 0,
        "ESTADO_PEDIDO": "F",
        "USUARIO": "KEVIMOJI",
        "FECHA_FACTURA": "2026-01-28 12:55:52.000",
        "FECHA_PEDIDO": "2026-01-17 00:00:00.000",
        "MODULO": "P",
        "CIA": "B",
        "placa": null,
        "tiene_servicio": "S",
        "SOLICITA": null,
        "ATENDIDO_POR": "Kevin Mojica",
        "FECHA": "2026-01-28 12:55:52.000",
        "ESTADO_PREPARACION": "0"
    },
    {
        "ITEM": "3",
        "DOCUMENTO": "F06-00080477",
        "PEDIDO": "P06-10105516",
        "DESCRIPCION": "MAURO SERVI .... 01/19/26  2:33:11 PM ",
        "CLIENTE": "MAURO SERVI",
        "TOTAL_UNIDADES": "2.00000000",
        "LINEAS_VERIFICADAS": ".00",
        "LINEAS_PREPARADAS": 0,
        "ESTADO_PEDIDO": "F",
        "USUARIO": "KEVIMOJI",
        "FECHA_FACTURA": "2026-01-23 13:06:12.000",
        "FECHA_PEDIDO": "2026-01-19 00:00:00.000",
        "MODULO": "P",
        "CIA": "B",
        "placa": null,
        "tiene_servicio": "N",
        "SOLICITA": null,
        "ATENDIDO_POR": "Kevin Mojica",
        "FECHA": "2026-01-23 13:06:12.000",
        "ESTADO_PREPARACION": "0"
    },
    {
        "ITEM": "4",
        "DOCUMENTO": "T06-00018197",
        "PEDIDO": "P06-10105573",
        "DESCRIPCION": "/ / / TRANSPORTES SPIEGEL, S.A. .... 01/21/26 11:44:07 AM ",
        "CLIENTE": "TRANSPORTES SPIEGEL, S.A.",
        "TOTAL_UNIDADES": "2.00000000",
        "LINEAS_VERIFICADAS": "2.00",
        "LINEAS_PREPARADAS": 0,
        "ESTADO_PEDIDO": "F",
        "USUARIO": "KEVIMOJI",
        "FECHA_FACTURA": "2026-01-22 13:38:33.000",
        "FECHA_PEDIDO": "2026-01-21 00:00:00.000",
        "MODULO": "P",
        "CIA": "B",
        "placa": null,
        "tiene_servicio": "S",
        "SOLICITA": "S",
        "ATENDIDO_POR": "Kevin Mojica",
        "FECHA": "2026-01-22 13:38:33.000",
        "ESTADO_PREPARACION": "G"
    },
    {
        "ITEM": "5",
        "DOCUMENTO": "F06-00080435",
        "PEDIDO": "P06-10105446",
        "DESCRIPCION": "/ DIAZ , GUSTAVO  .... 01/16/26  3:31:22 PM ",
        "CLIENTE": "DIAZ , GUSTAVO ",
        "TOTAL_UNIDADES": "4.00000000",
        "LINEAS_VERIFICADAS": ".00",
        "LINEAS_PREPARADAS": 0,
        "ESTADO_PEDIDO": "F",
        "USUARIO": "KEVIMOJI",
        "FECHA_FACTURA": "2026-01-22 13:20:20.000",
        "FECHA_PEDIDO": "2026-01-16 00:00:00.000",
        "MODULO": "P",
        "CIA": "B",
        "placa": null,
        "tiene_servicio": "N",
        "SOLICITA": null,
        "ATENDIDO_POR": "Kevin Mojica",
        "FECHA": "2026-01-22 13:20:20.000",
        "ESTADO_PREPARACION": "0"
    },
    {
        "ITEM": "6",
        "DOCUMENTO": "T06-00018208",
        "PEDIDO": "P06-10105439",
        "DESCRIPCION": "/ CARDENAS , JOSE  .... 01/16/26  2:32:44 PM ",
        "CLIENTE": "CARDENAS , JOSE ",
        "TOTAL_UNIDADES": "8.00000000",
        "LINEAS_VERIFICADAS": "8.00",
        "LINEAS_PREPARADAS": 0,
        "ESTADO_PEDIDO": "F",
        "USUARIO": "KEVIMOJI",
        "FECHA_FACTURA": "2026-01-21 17:00:57.000",
        "FECHA_PEDIDO": "2026-01-16 00:00:00.000",
        "MODULO": "P",
        "CIA": "B",
        "placa": null,
        "tiene_servicio": "S",
        "SOLICITA": null,
        "ATENDIDO_POR": "Kevin Mojica",
        "FECHA": "2026-01-21 17:00:57.000",
        "ESTADO_PREPARACION": "G"
    },
    {
        "ITEM": "7",
        "DOCUMENTO": "T06-00018141",
        "PEDIDO": "P06-10105364",
        "DESCRIPCION": "/ AGUILAR  , YAJAIRA  .... 01/13/26  4:23:17 PM ",
        "CLIENTE": "AGUILAR  , YAJAIRA ",
        "TOTAL_UNIDADES": "9.00000000",
        "LINEAS_VERIFICADAS": "8.00",
        "LINEAS_PREPARADAS": 0,
        "ESTADO_PEDIDO": "F",
        "USUARIO": "NATAGOME",
        "FECHA_FACTURA": "2026-01-17 15:14:05.000",
        "FECHA_PEDIDO": "2026-01-13 00:00:00.000",
        "MODULO": "P",
        "CIA": "B",
        "placa": "CB0514",
        "tiene_servicio": "S",
        "SOLICITA": null,
        "ATENDIDO_POR": "Natalie S. Gomez",
        "FECHA": "2026-01-17 15:14:05.000",
        "ESTADO_PREPARACION": "G"
    },
    {
        "ITEM": "8",
        "DOCUMENTO": "T06-00018139",
        "PEDIDO": "P06-10105478",
        "DESCRIPCION": "/ BELKIS .... 01/17/26 12:11:07 PM ",
        "CLIENTE": "BELKIS",
        "TOTAL_UNIDADES": "2.00000000",
        "LINEAS_VERIFICADAS": "2.00",
        "LINEAS_PREPARADAS": 0,
        "ESTADO_PEDIDO": "F",
        "USUARIO": "KEVIMOJI",
        "FECHA_FACTURA": "2026-01-17 13:04:43.000",
        "FECHA_PEDIDO": "2026-01-17 00:00:00.000",
        "MODULO": "P",
        "CIA": "B",
        "placa": null,
        "tiene_servicio": "S",
        "SOLICITA": null,
        "ATENDIDO_POR": "Kevin Mojica",
        "FECHA": "2026-01-17 13:04:43.000",
        "ESTADO_PREPARACION": "G"
    },
    {
        "ITEM": "9",
        "DOCUMENTO": "T06-00018138",
        "PEDIDO": "P06-10105477",
        "DESCRIPCION": "/ / LA SANTÉ .... 01/17/26 12:03:49 PM ",
        "CLIENTE": "LA SANTÉ",
        "TOTAL_UNIDADES": "4.00000000",
        "LINEAS_VERIFICADAS": "4.00",
        "LINEAS_PREPARADAS": 0,
        "ESTADO_PEDIDO": "F",
        "USUARIO": "KEVIMOJI",
        "FECHA_FACTURA": "2026-01-17 13:04:11.000",
        "FECHA_PEDIDO": "2026-01-17 00:00:00.000",
        "MODULO": "P",
        "CIA": "B",
        "placa": null,
        "tiene_servicio": "S",
        "SOLICITA": null,
        "ATENDIDO_POR": "Kevin Mojica",
        "FECHA": "2026-01-17 13:04:11.000",
        "ESTADO_PREPARACION": "G"
    },
    {
        "ITEM": "10",
        "DOCUMENTO": "T06-00017990",
        "PEDIDO": "P06-10105194",
        "DESCRIPCION": "/ / / / CENTRAL DE LUBRICANTES, S.A. .... 01/07/26  2:03:26 PM ",
        "CLIENTE": "CENTRAL DE LUBRICANTES, S.A.",
        "TOTAL_UNIDADES": "16.00000000",
        "LINEAS_VERIFICADAS": ".00",
        "LINEAS_PREPARADAS": 0,
        "ESTADO_PEDIDO": "F",
        "USUARIO": "NATAGOME",
        "FECHA_FACTURA": "2026-01-16 11:49:16.000",
        "FECHA_PEDIDO": "2026-01-07 00:00:00.000",
        "MODULO": "P",
        "CIA": "B",
        "placa": "BS4339",
        "tiene_servicio": "S",
        "SOLICITA": null,
        "ATENDIDO_POR": "Natalie S. Gomez",
        "FECHA": "2026-01-16 11:49:16.000",
        "ESTADO_PREPARACION": "0"
    },
    {
        "ITEM": "11",
        "DOCUMENTO": "F06-00080284",
        "PEDIDO": "P06-10105238",
        "DESCRIPCION": "/ JUNTA COMUNAL DE LAS GARZAS .... 01/08/26  1:11:24 PM ",
        "CLIENTE": "JUNTA COMUNAL DE LAS GARZAS",
        "TOTAL_UNIDADES": "4.00000000",
        "LINEAS_VERIFICADAS": ".00",
        "LINEAS_PREPARADAS": 0,
        "ESTADO_PEDIDO": "F",
        "USUARIO": "KEVIMOJI",
        "FECHA_FACTURA": "2026-01-16 11:45:36.000",
        "FECHA_PEDIDO": "2026-01-08 00:00:00.000",
        "MODULO": "P",
        "CIA": "B",
        "placa": null,
        "tiene_servicio": "N",
        "SOLICITA": null,
        "ATENDIDO_POR": "Kevin Mojica",
        "FECHA": "2026-01-16 11:45:36.000",
        "ESTADO_PREPARACION": "0"
    },
    {
        "ITEM": "12",
        "DOCUMENTO": "T06-00018023",
        "PEDIDO": "P06-10105268",
        "DESCRIPCION": "/ / SANCHEZPE , PEDRO WILIAN .... 01/10/26  9:38:32 AM ",
        "CLIENTE": "SANCHEZPE , PEDRO WILIAN",
        "TOTAL_UNIDADES": "6.00000000",
        "LINEAS_VERIFICADAS": "3.00",
        "LINEAS_PREPARADAS": 0,
        "ESTADO_PEDIDO": "F",
        "USUARIO": "KEVIMOJI",
        "FECHA_FACTURA": "2026-01-16 08:17:58.000",
        "FECHA_PEDIDO": "2026-01-10 00:00:00.000",
        "MODULO": "P",
        "CIA": "B",
        "placa": null,
        "tiene_servicio": "N",
        "SOLICITA": null,
        "ATENDIDO_POR": "Kevin Mojica",
        "FECHA": "2026-01-16 08:17:58.000",
        "ESTADO_PREPARACION": "G"
    },
    {
        "ITEM": "13",
        "DOCUMENTO": "F06-00080229",
        "PEDIDO": "P06-10105201",
        "DESCRIPCION": "/ / PANAMCO, INC .... 01/07/26  3:35:24 PM ",
        "CLIENTE": "PANAMCO, INC",
        "TOTAL_UNIDADES": "4.00000000",
        "LINEAS_VERIFICADAS": ".00",
        "LINEAS_PREPARADAS": 0,
        "ESTADO_PEDIDO": "F",
        "USUARIO": "KEVIMOJI",
        "FECHA_FACTURA": "2026-01-13 15:39:01.000",
        "FECHA_PEDIDO": "2026-01-07 00:00:00.000",
        "MODULO": "P",
        "CIA": "B",
        "placa": null,
        "tiene_servicio": "N",
        "SOLICITA": null,
        "ATENDIDO_POR": "Kevin Mojica",
        "FECHA": "2026-01-13 15:39:01.000",
        "ESTADO_PREPARACION": "0"
    },
    {
        "ITEM": "14",
        "DOCUMENTO": "T06-00018005",
        "PEDIDO": "P06-10105225",
        "DESCRIPCION": "/ CHAVEZ , VENACIO /APARTADO .... 01/08/26 10:48:21 AM ",
        "CLIENTE": "CHAVEZ , VENACIO /APARTADO",
        "TOTAL_UNIDADES": "8.00000000",
        "LINEAS_VERIFICADAS": ".00",
        "LINEAS_PREPARADAS": 0,
        "ESTADO_PEDIDO": "F",
        "USUARIO": "KEVIMOJI",
        "FECHA_FACTURA": "2026-01-08 10:49:24.000",
        "FECHA_PEDIDO": "2026-01-08 00:00:00.000",
        "MODULO": "P",
        "CIA": "B",
        "placa": "EK9415",
        "tiene_servicio": "S",
        "SOLICITA": null,
        "ATENDIDO_POR": "Kevin Mojica",
        "FECHA": "2026-01-08 10:49:24.000",
        "ESTADO_PREPARACION": "0"
    },
    {
        "ITEM": "15",
        "DOCUMENTO": "T06-00017974",
        "PEDIDO": "P06-10105153",
        "DESCRIPCION": "/ GONZALEZ , DENIA  .... 01/06/26  2:06:13 PM ",
        "CLIENTE": "GONZALEZ , DENIA ",
        "TOTAL_UNIDADES": "8.00000000",
        "LINEAS_VERIFICADAS": ".00",
        "LINEAS_PREPARADAS": 0,
        "ESTADO_PEDIDO": "F",
        "USUARIO": "KEVIMOJI",
        "FECHA_FACTURA": "2026-01-06 15:06:07.000",
        "FECHA_PEDIDO": "2026-01-06 00:00:00.000",
        "MODULO": "P",
        "CIA": "B",
        "placa": null,
        "tiene_servicio": "S",
        "SOLICITA": null,
        "ATENDIDO_POR": "Kevin Mojica",
        "FECHA": "2026-01-06 15:06:07.000",
        "ESTADO_PREPARACION": "0"
    },
    {
        "ITEM": "16",
        "DOCUMENTO": "F06-00080072",
        "PEDIDO": "P06-10105147",
        "DESCRIPCION": "/ SOLIS, JOSE .... 01/06/26 12:05:41 PM ",
        "CLIENTE": "SOLIS, JOSE",
        "TOTAL_UNIDADES": "4.00000000",
        "LINEAS_VERIFICADAS": ".00",
        "LINEAS_PREPARADAS": 0,
        "ESTADO_PEDIDO": "F",
        "USUARIO": "KEVIMOJI",
        "FECHA_FACTURA": "2026-01-06 12:06:39.000",
        "FECHA_PEDIDO": "2026-01-06 00:00:00.000",
        "MODULO": "P",
        "CIA": "B",
        "placa": null,
        "tiene_servicio": "N",
        "SOLICITA": null,
        "ATENDIDO_POR": "Kevin Mojica",
        "FECHA": "2026-01-06 12:06:39.000",
        "ESTADO_PREPARACION": "0"
    },
    {
        "ITEM": "17",
        "DOCUMENTO": "T06-00017951",
        "PEDIDO": "P06-10105095",
        "DESCRIPCION": "PRONTO ASEO, S.A. .... 01/05/26 11:29:52 AM ",
        "CLIENTE": "PRONTO ASEO, S.A.",
        "TOTAL_UNIDADES": "4.00000000",
        "LINEAS_VERIFICADAS": ".00",
        "LINEAS_PREPARADAS": 0,
        "ESTADO_PEDIDO": "F",
        "USUARIO": "KEVIMOJI",
        "FECHA_FACTURA": "2026-01-05 15:10:15.000",
        "FECHA_PEDIDO": "2026-01-05 00:00:00.000",
        "MODULO": "P",
        "CIA": "B",
        "placa": null,
        "tiene_servicio": "S",
        "SOLICITA": null,
        "ATENDIDO_POR": "Kevin Mojica",
        "FECHA": "2026-01-05 15:10:15.000",
        "ESTADO_PREPARACION": "0"
    },
    {
        "ITEM": "18",
        "DOCUMENTO": "T06-00017901",
        "PEDIDO": "P06-10105019",
        "DESCRIPCION": "/ CENTRAL DE LUBRICANTES, S.A. .... 01/02/26  3:04:45 PM ",
        "CLIENTE": "CENTRAL DE LUBRICANTES, S.A.",
        "TOTAL_UNIDADES": "10.00000000",
        "LINEAS_VERIFICADAS": "10.00",
        "LINEAS_PREPARADAS": 0,
        "ESTADO_PEDIDO": "F",
        "USUARIO": "KEVIMOJI",
        "FECHA_FACTURA": "2026-01-05 13:26:38.000",
        "FECHA_PEDIDO": "2026-01-02 00:00:00.000",
        "MODULO": "P",
        "CIA": "B",
        "placa": "639393",
        "tiene_servicio": "S",
        "SOLICITA": null,
        "ATENDIDO_POR": "Kevin Mojica",
        "FECHA": "2026-01-05 13:26:38.000",
        "ESTADO_PREPARACION": "G"
    }
];


Chart.defaults.color = '#8b949e'; // Color de texto
Chart.defaults.borderColor = '#30363d'; // Color de líneas de división
document.addEventListener("DOMContentLoaded", function () {
    localStorage.clear();
    $(".dropdown-trigger").dropdown();
     renderizarDashboardWMS();
        actualizarKpisConDatosReales(dataPedidos) 

});

Chart.defaults.color = '#8b949e';
Chart.defaults.borderColor = '#30363d';
document.addEventListener("DOMContentLoaded", function () {
        M.AutoInit();             
        renderizarDashboardWMS();
        });

function renderizarDashboardWMS() {
    // 1. Gráfica de Barras: Estado de Pedidos (Pendiente, En Picking, Empacado, Despachado)
new Chart(document.getElementById('chartStatus'), {
        type: 'bar',
        data: {
            labels: ['Pendiente', 'Facturados', 'Orden de Taller', 'Despachado'],
            datasets: [{
                label: 'Cantidad de Pedidos',
                data: [450, 320, 280, 890],
                backgroundColor: '#00ced1',
                borderRadius: 4
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: { legend: { display: false } }
        }
    });

    // // 2. Gráfica de Dona: Ocupación de Bodega por Tipo de Producto o Zona
new Chart(document.getElementById('chartZonas'), {
            type: 'doughnut',
            data: {
                labels: ['Rack A (Llantas)', 'Rack B (Aceites)', 'Rines', 'Filtros'],
                datasets: [{
                    data: [40, 15, 25, 20],
                    backgroundColor: ['#008080', '#2a9d8f', '#e9c46a', '#f4a261'],
                    borderWidth: 0,
                    // Estos valores crean el efecto de medidor
                    circumference: 180, // Solo media circunferencia
                    rotation: 270,      // Inicia desde la izquierda (9 en reloj)
                    cutout: '80%'       // Grosor del arco
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                aspectRatio: 2, // Ayuda a que no quede espacio vacío abajo
                plugins: {
                    legend: {
                        position: 'bottom',
                        labels: {
                            boxWidth: 12
                        }
                    },
                    tooltip: {
                        enabled: true
                    }
                },
                layout: {
                    padding: {
                        bottom: 20
                    }
                }
            }
    }); 

}

document.getElementById("bodega").addEventListener('change', function() {
    console.log("Cambiando datos para bodega: " + this.value);   
});




function cargarTabla(datos) {
    const tbody = document.getElementById('tbodyPedidos');
    tbody.innerHTML = ""; // Limpiar tabla

    datos.forEach(p => {
        // Formatear el estado para que se vea mejor
        let badgeColor = p.ESTADO_PREPARACION === "G" ? "green" : "orange";
        let estadoTxt = p.ESTADO_PREPARACION === "G" ? "Listo" : "Pendiente";

        const row = `
            <tr>
                <td>${p.ITEM}</td>
                <td><b>${p.DOCUMENTO}</b></td>
                <td>${p.PEDIDO}</td>
                <td>${p.CLIENTE}</td>
                <td>${parseFloat(p.TOTAL_UNIDADES).toFixed(0)}</td>
                <td>${p.ATENDIDO_POR}</td>
                <td><span class="new badge ${badgeColor}" data-badge-caption="">${estadoTxt}</span></td>
            </tr>
        `;
        tbody.innerHTML += row;
    });
}

// Inicializar tabla al cargar
cargarTabla(dataPedidos);

// Lógica del Buscador en tiempo real
document.getElementById('txtBuscadorTabla').addEventListener('keyup', function(e) {
    const busqueda = e.target.value.toLowerCase();
    const filtrados = dataPedidos.filter(p => 
        p.CLIENTE.toLowerCase().includes(busqueda) || 
        p.PEDIDO.toLowerCase().includes(busqueda) ||
        p.DOCUMENTO.toLowerCase().includes(busqueda)
    );
    cargarTabla(filtrados);
});